<?xml version="1.0" encoding="gbk" ?>
<function id="60110102" name="流水录入" >
	<input>
		<item type="hidden" id="sbond_id" name="交易协议书id"  action="60010406"/>
		<group name="交易协议书基本要素">    
			<item type="hidden" id="cust_id" name="客户id"/>
			<item type="text" id="sbond_no" name="交易协议书编号" editable="false"/>
			<item type="text" id="related_sbond_no" name="关联(主)交易协议书编号" editable="false"/>
			<item type="text" id="mortgagee_type_name" name="质权人类型" editable="false"/>
			<item type="text" id="mortgagee_name" name="质权人名称" editable="false"/>			
			<item type="text" id ="cust_code" name="客户代码" editable="false"/>
            <item type="hidden" id="institution_code"  name="营业部代码" />            
			<item type="text" id="cust_name" name="客户姓名" editable="false"/>	
			<item type="text" id="bond_status_name" name="合同状态" editable="false"/>	
            <item type="text" id="market_code" name="市场代码" editable="false"/>	
			<item type="text" id="product_code" name="证券代码" editable="false"/>
			<item type="text" id="product_name" name="证券名称" editable="false"/>
			<item type="text" id="product_type" name="证券类型" editable="false"/>
			<item type="text" id="stock_property" name="股份性质" editable="false"/>
			<item type="text" id="mortgagee_type_name" name="质权人类型" editable="false"/>
			<item type="text" id="mortgagee_name" name="质权人名称" editable="false"/>
			<item type="text" id="hg_num" name="交易数量" editable="false"/>
		</group>
		<group name="交易要素">			
			<item type="text" id="first_amt" name="初始交易金额" editable="false"/>	
			<item type="text" id="second_amt" name="购回交易金额" editable="false"/>	
			<item type="text" id="engage_trade_date" name="初始交易日期" editable="false"/>
			<item type="text" id="days" name="购回期限(天)" editable="false"/>
			<item type="text" id="bb_date" name="购回交易日期" editable="false"/>
			<item type="text" id="sbond_status_name" name="交易协议书状态" editable="false"/>
			<item type="text" id="manual_chg"   name="购回金额手工调整" editable="false"/>
			<item type="text" id="penalty_rate" name="违约金比率(日利率%)" editable="false"/>
			<item type="text" id="fix_rate" name="固定交易费用比例(%)" editable="false"/>
			<item type="select" id ="if_before" name="是否允许提前购回" editable="false" source="813"/>
			<item type="date" 	id ="earliest_bb_date" name="被允许的最早购回时点" editable="false"/>
			<item type="text"	id ="before_rate" name="提前购回补偿费率(%)" editable="false"/>
			<item type="select" id ="if_after" name="是否允许延期购回" editable="false" source="815"/>
			<item type="date" 	id ="latest_bb_date" name="被允许的最晚购回时点" editable="false"/>
			<item type="text"	id ="after_rate" name="延期购回补偿费率(%)" editable="false"/>
			<item type="text"	id ="tqxs" name="提取系数" editable="false"/>
            <item type="textarea" id ="zjyt" name="资金用途" editable="false"/>
			<item type="textarea" id ="remarks" name="备注" editable="false"/>
		</group>
		<group name="逐日盯市信息">
			<item type="text" id="curr_stk_vol" name="当前证券数量" editable="false"/>
             <item type="text" id="curr_debt_amt"            name="当前负债金额"       editable="false"/>
			<item type="text" id="hl_remain" name="红利剩余金额" editable="false"/>
			<item type="text" id="days2" name="最新购回期限(天)" editable="false"/>
			<item type="text" id="second_amt2" name="最新购回交易金额" editable="false"/>
			<item type="text" id="last_bb_date" name="最新约定购回日期" editable="false"/>
			<item type="text" id="last_bb_reason" name="最新购回日期变更原因" editable="false"/>
			<item type="text" id="bring_forward" name="是否需要提前回购" editable="false"/>
			<item type="text" id="fulfillment_rate" name="履约能力指标" editable="false"/>
			<item type="text" id="interest" name="累计利息" editable="false"/>
			<item type="text" id="penalty_count" name="已计违约金积数" editable="false"/>
			<item type="text" id="penalty" name="累计违约金" editable="false"/>
			<item type="text" id="unreceived_interest" name="已结未收利息" editable="false"/>
			<item type="text" id="unreceived_penalty" name="已结未收违约金" editable="false"/>
			<item type="text" id="received_interest" name="已收利息" editable="false"/>
			<item type="text" id="received_penalty" name="已收违约金" editable="false"/>
			<item type="text" id="real_interest" name="实时利息" editable="false"/>
			<item type="text" id="real_penalty" name="实时违约金" editable="false"/>
			<item type="select" id="violate_type" name="违约类型" editable="false" source="731"/>
            <item type="text" id="before_fee"               name="未收提前购回补偿费" editable="false"/>
			<item type="text" id="received_before_fee"      name="已收提前购回补偿费" editable="false"/>
			<item type="text" id="unreceived_after_fee"     name="未收延期购回补偿费" editable="false"/>
			<item type="text" id="received_after_fee"       name="已收延期购回补偿费" editable="false"/>
			<item type="text" id="real_after_fee"           name="实时延期购回补偿费" editable="false"/>
			<item type="text" id="received_other_fee"       name="已收其他费用"       editable="false"/>
			<item type="text" id="received_other_refund"    name="已退还其他费用"     editable="false"/>
            <item type="text"     id="handle_date"          name="处置日期"          editable="false"/>
			<item type="textarea" id="mtm_remark"           name="备注" editable="false"/>
            
		</group>
        
		<group name="交易流水录入">
			<item type="select"      id="flow_type"         name="流水类型:"  source="839" />
			<item type="text"        id="return_amt"        name="金额"       nullable="false"	number="true" minlen="1" maxlen ="19" />
			<item type="textarea"    id="remark"            name="备注"/>
            <item type="hidden"      id="func_id" 			action="8801" 	default="60110102"/>
            <item type="hidden"      id="func_need_check"     name="是否支持复核" 	  default="0"/>	
		</group>
        
        <group name="复核">      	
            <item type="text" 		id="chk_user_code" 		 name="复核人员" filter="func_need_check=1"/>
            <item type="password"   id="chkuser_pwd" 		 name="密码" 	filter="func_need_check=1"/>
        </group>		
	</input> 
    
    <service type="procedure" id="P60110102" process="933" style="1">
        <param id="user_id"			    type="integer" way="in"/>
        <param id="func_id"			    type="integer" way="in"/>
        <param id="chk_user_code"	    type="string"  way="in"/>
        <param id="chkuser_pwd"	  	    type="string"  way="in"/>        
        <param id="sbond_id"            type="integer" way="in"/>
        <param id="cust_code"	        type="string"  way="in"/>
        <param id="institution_code"	type="string"  way="in"/>
        <param id="flow_type"           type="string"  way="in"/>
        <param id="return_amt"	        type="number"  way="in"/>
        <param id="remark"	            type="string"  way="in"/>
   </service>
   
   <output target="@func_no">
        <column type="string"       id="scust_no"         		name="客户代码"/>
        <column type="string"       id="scurrency_type"       	name="货币类型"/>  
        <column type="string"       id="sstatus0"      		    name="业务标识"/>  
        <column type="number"       id="damt2"        		    name="违约金"/>
        <column type="number"       id="damt17"           		name="资金发生"/>
        <column type="string"       id="sbranch_code0"        	name="发生营业部"/>
        <column type="string"       id="sstation0"       		name="委托来源"/> 
        <column type="string"       id="func_no"           		name="功能号"/> 
        <column type="string"       id="snote"	 		        name="备注"/>
        <column type="integer"      id="lwithdraw_flag"	 		name="判断复核"/>
        <column type="integer"      id="lsafe_level" 		    name="红冲蓝补"/>
        <column type="string"       id="semp"		 	 		name="员工号"/>
        <column type="integer"      id="sbond_id"        	    name="协议书ID"/>
        <column type="string"       id="flow_type"		 	 	name="流水类型"/>
        <column type="number"       id="return_amt"		 	    name="归还金额"/>   
        <column type="string"       id="remark"		 	        name="备注"/>    
    </output>
</function>